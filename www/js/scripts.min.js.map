{"version":3,"sources":["_functions.js","_socketSetup.js","_auth.js","_config.js","_init.js","scripts.js"],"names":["logText","text","devLog","currentTime","Date","currentHours","getHours","currentMinutes","getMinutes","currentSeconds","getSeconds","currentMillis","getMilliseconds","hoursZero","minutesZero","secondsZero","millisZero","timestamp","textArray","split","i","length","$","prepend","populateActions","each","index","el","attr","allCuts","uuid","unbind","isTouchDevice","tooltip","click","googleAnalytics","this","parents","socketSend","action","args","modalMessage","modalTitle","modalBody","html","modal","resetForm","form","find","val","removeAttr","selector","prop","jdata","SID","socket","readyState","sid","send","JSON","stringify","changeAttr","taskid","attrKey","attrVal","rickRoll","easterEggs","addClass","window","DocumentTouch","document","s","o","g","r","a","m","config","google_analytics_key","ga","socketSetup","host","WebSocket","onopen","setInterval","CONNECTING","refreshRate","onmessage","msg","jsonData","parse","data","oldJsonData","extend","admin_mode_enabled","auths","indexOf","substring","authed","onDeauth","onAuth","deauths","onFailedauth","queue","arrayIndex","arrayEl","displayEl","material","materials","priority","priorities","timetotal","esttime","hours","Math","floor","minutes","seconds","toFixed","output","String","concat","render","renderDirectives","draggable","draggabilly","axis","container","on","event","pointer","round","position","y","allow_force_refresh","location","reload","onerror","error","origin","random","setTimeout","logout","login","getConfigFile","reconnectRate","buttons","params","coachmodified","modified_hover","actions","Object","keys","button","authactions","pass_depth","v1","console","log","getJSON","responseJSON","dev_log","slideUp","port","easter_eggs","default_material","append","material_input","selected","priority_choose","priority_input","p","disabled","default_priority","priority_selection","name_input","time_input","name_hover","time_hover","material_hover","priority_hover","action_header","name_header","material_header","time_header","priority_header","remove","remove_hover","increment","incr_hover","decrement","decr_hover","pass","pass_hover","submit","preventDefault","sha1","q","push","arguments","l","createElement","getElementsByTagName","async","src","parentNode","insertBefore","cookieDomain","CLOSED","ajax","url","type","done","request","before","marked","fail","focus","ready","clickAction","estimate","match","easterEgg","Konami","code","load"],"mappings":"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","file":"scripts.min.js","sourcesContent":["// put any utilities and functions etc in here\n\n\n// logs text to devlog on page\nfunction logText(text) {\n\tif(devLog) {\n\t\tvar currentTime = new Date();\n\t\tvar currentHours = currentTime.getHours();\n\t\tvar currentMinutes = currentTime.getMinutes();\n\t\tvar currentSeconds = currentTime.getSeconds();\n\t\tvar currentMillis = currentTime.getMilliseconds();\n\n\t\tvar hoursZero = (currentHours < 10 ? '0' : '');\n\t\tvar minutesZero = (currentMinutes < 10 ? '0' : '');\n\t\tvar secondsZero = (currentSeconds < 10 ? '0' : '');\n\t\tvar millisZero = (currentMillis < 10 ? '00' : currentMillis < 100 ? '0' : '');\n\t\tvar timestamp = '[' + hoursZero + currentHours + ':' + minutesZero + currentMinutes + ':' + secondsZero + currentSeconds + '.' + millisZero + currentMillis + ']';\n\n\t\tvar textArray = text.split('\\n');\n\n\t\tfor (var i = textArray.length - 1; i >= 0; i--) {\n\t\t\t$('.log-pre').prepend('<span class=\"log-time\"> ' + timestamp + ':</span> ' + textArray[i] + '\\n');\n\t\t}\n\t}\n}\n\n// repopulate action button UUIDs\nfunction populateActions() {\n\tlogText('Populating actions');\n\n\t$('.cutting-table-template tr').each(function(index, el) {\n\t\t$(el).attr('data-uuid', allCuts[index].uuid);\n\t\t$(el).attr('data-pos', index);\n\t\t$(el).unbind('click');\n\t});\n\n\t// reinitialize bootstrap tooltips\n\tif(isTouchDevice() == false) {\n\t\t$('[data-toggle=\"tooltip\"]').tooltip();\n\t}\n\n\t// handler to remove a job\n\t$('.remove-job').click(function() {\n\t\tgoogleAnalytics('send', 'event', 'action', 'click', 'remove job');\n\t\tlogText('removing item ' + $($(this).parents()[1]).attr('data-uuid'));\n\t\tsocketSend({\n\t\t\t'action': 'remove',\n\t\t\t'args': [$($(this).parents()[1]).attr('data-uuid')]\n\t\t});\n\t});\n\n\t// handler to lower a job\n\t$('.lower-priority').click(function() {\n\t\tgoogleAnalytics('send', 'event', 'action', 'click', 'pass job');\n\t\tlogText('passing item ' + $($(this).parents()[1]).attr('data-uuid'));\n\t\tsocketSend({\n\t\t\t'action': 'pass',\n\t\t\t'args': [$($(this).parents()[1]).attr('data-uuid')]\n\t\t});\n\t});\n\n\t// handler to decrement a job\n\t$('.decrement-job').click(function() {\n\t\tgoogleAnalytics('send', 'event', 'action', 'click', 'decrement job');\n\t\tlogText('removing item ' + $($(this).parents()[1]).attr('data-uuid'));\n\t\tsocketSend({\n\t\t\t'action': 'decrement',\n\t\t\t'args': [$($(this).parents()[1]).attr('data-uuid')]\n\t\t});\n\t});\n\n\t// handler to increment a job\n\t$('.increment-job').click(function() {\n\t\tgoogleAnalytics('send', 'event', 'action', 'click', 'increment job');\n\t\tlogText('passing item ' + $($(this).parents()[1]).attr('data-uuid'));\n\t\tsocketSend({\n\t\t\t'action': 'increment',\n\t\t\t'args': [$($(this).parents()[1]).attr('data-uuid')]\n\t\t});\n\t});\n}\n\n// displays message in a bootstrap modal\nfunction modalMessage(modalTitle, modalBody) {\n\t$('.notify-modal-title').html(modalTitle);\n\t$('.notify-modal-body').html(modalBody);\n\t$('#notify-modal').modal();\n}\n\n// reset a form with thanks to http://stackoverflow.com/questions/680241/resetting-a-multi-stage-form-with-jquery\nfunction resetForm(form) {\n\tform.find('input:text, input:password, input[type=number], input:file, textarea').val(''); // removed 'select'\n\tform.find('input:radio, input:checkbox').removeAttr('checked').removeAttr('selected');\n\tif($(form).selector == '.new-cut-form') {\n\t\tform.find('.selected').prop('selected', true);\n\t}\n}\n\n// adds SID to JSON and sends over websockets if the connection is stable\nfunction socketSend(jdata) {\n\t// if a session ID has been set and the socket is ready\n\tif(typeof SID != \"undefined\" && socket.readyState == 1) {\n\t\tjdata.sid = SID;\n\t\tsocket.send(JSON.stringify(jdata));\n\t} else {\n\t\t// if not sending, log why\n\t\tif(typeof SID != \"undefined\") {\n\t\t\tlogText(\"socketSend() has been called, but SID is undefined.\");\n\t\t}\n\t\tif(socket.readyState != 1) {\n\t\t\tlogText(\"socketSend() has been called, but socket.readyState is not 1. The socket is probably not connected yet.\");\n\t\t}\n\t}\n}\n\n// wrapper for socketSend that changes an item's attribute\nfunction changeAttr(taskid, attrKey, attrVal) {\n\tif(typeof taskid == 'string') {\n\t\tsocketSend({\n\t\t\t'action': 'attr',\n\t\t\t'args': [taskid, attrKey, attrVal]\n\t\t});\n\t} else if(typeof taskid == 'number') {\n\t\tchangeAttr(allCuts[taskid].uuid, attrKey, attrVal);\n\t} else if(typeof taskid == 'object') {\n\t\tchangeAttr($(taskid).attr('data-uuid'), attrKey, attrVal);\n\t} else {\n\t\tlogText('changeAttr() called with invalid taskid type');\n\t}\n}\n\n// read the function name, it says it all\nfunction rickRoll() {\n\tif (easterEggs) {\n\t\tmodalMessage('Never gonna give you up', '<iframe width=\"420\" height=\"315\" src=\"http://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&disablekb=1&controls=0&loop=1&showinfo=0&iv_load_policy=3\" frameborder=\"0\" allowfullscreen></iframe>');\n\t\t$('html').addClass('lol');\n\t}\n\telse {\n\t\tlogText('This is a serious establishment, son. I\\'m dissapointed in you.');\n\t}\n}\n\n// checks if the device is a touch device\nfunction isTouchDevice(){\n\treturn true == ('ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n}\n\n// ga() if Google Analytics is enabled\nfunction googleAnalytics(i, s, o, g, r, a, m){\n\tif (config.google_analytics_key != '') {\n\t\tga(i, s, o, g, r, a, m);\n\t}\n}\n","// a function to set up WebSockets\n\nfunction socketSetup() { // god help me\n\n\t// wait until host has a real value\n\twhile(host == 'undefined') {}\n\tsocket = new WebSocket(host);\n\n\t// when websockets connects\n\tsocket.onopen = function() {\n\t\t// print to log and consoles\n\t\tlogText('WebSockets connection opened successfully');\n\n\t\t$('#notify-modal').modal('hide');\n\n\t\t// poll for new data and repeat every refreshRate\n\t\tsocketSend({'action': 'null'});\n\t\tsetInterval(function () {\n\t\t\tif(socket.readyState != socket.CONNECTING) {\n\t\t\t\tsocketSend({'action': 'null'});\n\t\t\t}\n\t\t},refreshRate);\n\t};\n\n\t// when websockets message\n\tsocket.onmessage = function(msg) {\n\n\t\t// loads JSON data\n\t\tjsonData = JSON.parse(msg.data);\n\n\t\t// if data is new\n\t\tif(JSON.stringify(jsonData) !== JSON.stringify(oldJsonData)) {\n\t\t\n\t\t\t// deep copy jsonData to oldJsonData\n\t\t\toldJsonData = $.extend({}, jsonData);\n\t\t\t\n\t\t\t// log the new data\n\t\t\tlogText('new JSON received: ' + JSON.stringify(jsonData));\n\n\t\t\t// if being told to render table\n\t\t\tif(jsonData.action == 'display') {\n\n\t\t\t\t// reinitialize full list of cuts\n\t\t\t\tallCuts = [];\n\n\t\t\t\tif (config.admin_mode_enabled) {\n\t\t\t\t\tif (jsonData.auths.indexOf(SID.substring(0, 18)) < 0 && authed) {\n\t\t\t\t\t\tonDeauth();\n\t\t\t\t\t}\n\t\t\t\t\telse if (jsonData.auths.indexOf(SID.substring(0, 18)) >= 0 && !authed) {\n\t\t\t\t\t\tonAuth();\n\t\t\t\t\t}\n\t\t\t\t\telse if (jsonData.deauths.indexOf(SID.substring(0, 18)) >= 0 && !authed) {\n\t\t\t\t\t\tonFailedauth();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// for each priority in list\n\t\t\t\t$(jsonData.queue).each(function(index, el) {\n\n\t\t\t\t\t// for each cut in priority\n\t\t\t\t\t$(el).each(function(arrayIndex, arrayEl) {\n\t\t\t\t\t\t// at this point nothing is human-readable\n\t\t\t\t\t\t// make material human-readable\n\t\t\t\t\t\tdisplayEl = $.extend({}, arrayEl); // deepcopy\n\t\t\t\t\t\tdisplayEl.material = materials[arrayEl.material];\n\t\t\t\t\t\tdisplayEl.priority = priorities[arrayEl.priority];\n\t\t\t\t\t\tvar timetotal = arrayEl.esttime;\n\t\t\t\t\t\tvar hours = Math.floor(timetotal/60);\n\t\t\t\t\t\ttimetotal -= hours*60;\n\t\t\t\t\t\tvar minutes = Math.floor(timetotal);\n\t\t\t\t\t\ttimetotal -= minutes;\n\t\t\t\t\t\tvar seconds = +(timetotal*60).toFixed(2);\n\n\t\t\t\t\t\tvar output = String(hours ? hours+'h' : '') + (minutes && hours ? ' ' : '');\n\t\t\t\t\t\toutput += String(minutes ? minutes+'m' : '') + (seconds && minutes ? ' ' : '');\n\t\t\t\t\t\toutput += String(seconds ? seconds+'s' : '')\n\n\t\t\t\t\t\tdisplayEl.esttime = output;\n\t\t\t\t\t\t// add to full list of cuts\n\t\t\t\t\t\tallCuts = allCuts.concat(displayEl);\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// render allCuts into table\n\t\t\t\t$('.cutting-table-template').render(allCuts, renderDirectives);\n\t\t\t\tpopulateActions();\n\n\t\t\t\t// make items draggable anywhere if authed\n\t\t\t\tif(authed) {\n\t\t\t\t\t$('.cutting-table-template tr').each(function(index, el) {\n\t\t\t\t\t\tdraggable[index] = this;\n\t\t\t\t\t\t$(this).draggabilly({\n\t\t\t\t\t\t\taxis: 'y',\n\t\t\t\t\t\t\tcontainer: $('.cutting-table-template')//,\n\t\t\t\t\t\t\t// grid: [ 37, 37 ]\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$(this).on('dragEnd', function(event, pointer) {\n\t\t\t\t\t\t\tsocketSend({\n\t\t\t\t\t\t\t\t'action': 'relmove',\n\t\t\t\t\t\t\t\t'args': [\n\t\t\t\t\t\t\t\t\t$(this).attr('data-uuid'),\n\t\t\t\t\t\t\t\t\t+$(this).attr('data-pos') + +Math.round($(this).data('draggabilly').position.y / 37)\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else if(jsonData.action == 'rickroll') {\n\t\t\trickRoll();\n\t\t} else if(jsonData.action == 'refresh' && config.allow_force_refresh) {\n\t\t\twindow.location.reload();\n\t\t}\n\t};\n\n\t// when websockets error\n\tsocket.onerror = function(error) {\n\t\t// go tell a nerd\n\t\tmodalMessage('Error 4', 'Could not connect to socket at ' + host + '. Maybe the backend is not running? This page will try to reconnect every few seconds. <br><br> <button class=\"btn btn-default btn-pink btn-retry\">Retry</button>');\n\n\t\t// set up retry button\n\t\t$('.btn-retry').click(function() {\n\t\t\twindow.location = window.location.origin + '?foo=' + Math.floor(Math.random()*11000);\n\t\t});\n\t};\n};\n\n","function onAuth() {\n\tauthed = true;\n\tlogText('Displaying authed modal.');\n\tmodalMessage('Success!', '<p class=\"lead\">You\\'ve been authorized!</p>');\n\tsetTimeout('\n\t\t$(\"#notify-modal\").modal(\"hide\");\n\t', 1000);\n\t$('.cutting-table-template').render(allCuts, renderDirectives);\n\t$('.disabled').prop('disabled', false);\n\t$('.authorize').attr('data-original-title', config.logout);\n\t$('.nuvu-logo').attr('src', '/img/admin-logo.svg');\n}\n\nfunction onFailedauth() {\n\tmodalMessage('Failure', '<p class=\"lead\">Unfortunately, it looks like your password was wrong.</p>');\n\tlogText('Password was wrong. Added to deauths. Shame activated. You\\'re bad and you should feel bad.');\n\tsocketSend({'action':'shame'});\n}\n\nfunction onDeauth() {\n\tauthed = false;\n\tlogText('User has been deauthed.');\n\t$('.cutting-table-template').render(allCuts, renderDirectives);\n\t$('.disabled').prop('disabled', true);\n\t$('.authorize').attr('data-original-title', config.login);\n\t$('.nuvu-logo').attr('src', '/img/logo.svg');\n\t$(draggable).draggabilly('disable');\n}","// gets the config file and parses values\n\n// declare almost all globals here\nvar getConfigFile, config, host, jsonData, socket, materials, priorities,  refreshRate, reconnectRate, easterEggs, SID, buttons,\n    authed = false,\n    allCuts = [],\n    displayEl = {},\n    renderDirectives = {\n\t\tpriority: {\n\t\t\thtml: function(params) {\n\t\t\t\treturn this.priority + (\n\t\t\t\t\tthis.coachmodified ? \n\t\t\t\t\t\t' <span class=\"glyphicon glyphicon-cog coach-modified\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"' + config.modified_hover + '\"></span>'\n\t\t\t\t\t\t: ''\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t\tactions: {\n\t\t\thtml: function(params) {\n\t\t\t\tvar data = '';\n\t\t\t\tfor (var i = 0; i < Object.keys(buttons).length; i++) {\n\t\t\t\t\tvar button = Object.keys(buttons)[i];\n\t\t\t\t\tif (config.authactions.indexOf(button) == -1 || authed) {\n\t\t\t\t\t\tif (button != \"pass\" || !(params.index >= config.pass_depth && config.pass_depth || authed)) {\n\t\t\t\t\t\t\tdata += buttons[button];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn data;\n\t\t\t},\n\t\t}\n\t},\n\tdraggable = [];\n\n// generate a session ID\nSID = uuid.v1();\nwindow.console.log('SID: ' + SID);\n\n// fetches config file from server\ngetConfigFile = $.getJSON('/config.json', function() {\n\n\t// config.thing returns thing in the config file\n\tconfig = getConfigFile.responseJSON;\n\n\t// hide and disable log if not enabled\n\tdevLog = config.dev_log;\n\tif(devLog != true) { $('[for=log-checkbox]').slideUp(); }\n\tlogText('Log starts here');\n\n\t// log entire config file\n\tlogText('Config file follows: ' + JSON.stringify(config, null, 2));\n\n\t// set host from host and port\n\thost = 'ws://' + config.host + ':' + config.port;\n\n\t// set materials and priorities in the same way\n\tmaterials = config.materials;\n\tpriorities = config.priorities;\n\n\t// set refreshRate and reconnectRate\n\trefreshRate = config.refreshRate;\n\treconnectRate = config.reconnectRate;\n\n\teasterEggs = config.easter_eggs;\n\n\t// render the materials dropdown\n\tif (config.default_material == \"\") {\n\t\t$('#cut-material').append('\n\t\t\t<option disabled selected value=\"N/A\" class=\"selected\">' + config.material_input + '</option>\n\t\t');\n\t}\n\t\n\tfor(var m in materials) {\n\t\tvar selected = (m === config.default_material ? 'selected' : '');\n\t\t$('#cut-material').append('\n\t\t\t<option ' + selected + ' value=\"' + m + '\" class=\"'+selected+'\">' + materials[m] + '</option>\n\t\t');\n\t}\n\n\t// render the priorities dropdown\n\tif (config.priority_choose) {\n\t\t$('#priority-dropdown').append('\n\t\t\t<option disabled selected value=\"-1\" class=\"selected\">' + config.priority_input + '</option>\n\t\t');\n\t}\n\tfor(var p in priorities) {\n\t\tvar disabled = (p < config.default_priority && !config.priority_selection ? 'disabled ' : '');\n\t\tvar selected = (p == config.default_priority && !config.priority_choose ? 'selected' : '');\n\t\t$('#priority-dropdown').append('\n\t\t\t<option ' + selected + ' value=\"' + String(priorities.length-p-1) + '\"  class=\"'+ disabled + selected + '\">' + priorities[p] + '</option>\n\t\t');\n\t}\n\n\tif (!config.priority_selection) {\n\t\t$('.disabled').prop('disabled', true);\n\t}\n\n\t$('.cut-human-name').attr('placeholder', config.name_input);\n\t$('.cut-time-estimate').attr('placeholder', config.time_input);\n\t$('.cut-human-name').attr('title', config.name_hover);\n\t$('.cut-time-estimate').attr('title', config.time_hover);\n\t$('.cut-material').attr('title', config.material_hover);\n\t$('.priority-dropdown').attr('title', config.priority_hover);\n\n\t$('.action-header').text(config.action_header);\n\t$('.name-header').text(config.name_header);\n\t$('.material-header').text(config.material_header);\n\t$('.time-header').text(config.time_header);\n\t$('.priority-header').text(config.priority_header);\n\n\n\n  buttons = {\n  \t'remove': '\\n<a role=\"button\" tabindex=\"0\" class=\"glyphicon glyphicon-remove remove-job\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"' + config.remove_hover + '\"></a>',\n  \t'increment': '\\n<a role=\"button\" tabindex=\"0\" class=\"glyphicon glyphicon-chevron-up increment-job\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"' + config.incr_hover + '\"></a>',\n  \t'decrement': '\\n<a role=\"button\" tabindex=\"0\" class=\"glyphicon glyphicon-chevron-down decrement-job\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"' + config.decr_hover + '\"></a>',\n  \t'pass': '\\n<a role=\"button\" tabindex=\"0\" class=\"glyphicon glyphicon-triangle-bottom lower-priority\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"' + config.pass_hover + '\"></a>'\n  };\n\n\tif (config.admin_mode_enabled) {\n\t\t$('.authorize').click(function() {\n\t\t\tif (authed) {\n\t\t\t\tsocketSend({'action': 'deauth'});\n\t\t\t\t$('.authorize').tooltip('hide');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmodalMessage('Authenticate', '\n\t\t\t\t\t<form class=\"login-form\">\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"password\">Password</label>\n\t\t\t\t\t\t\t<input type=\"password\" class=\"form-control coach-password\" id=\"password\" placeholder=\"Password\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type=\"submit\" class=\"btn btn-default\">Sign in</button>\n\t\t\t\t\t</form>\n\t\t\t\t');\n\t\t\t\t$('.authorize').tooltip('hide');\n\n\t\t\t\tsetTimeout('\n\t\t\t\t\t$(\".coach-password\").focus();\n\t\t\t\t',500);\n\n\t\t\t\t\n\n\t\t\t\t$('.login-form').submit(function(event) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tif($('#password').val() != '') {\n\t\t\t\t\t\tlogText('Password entered. Attempting auth.');\n\t\t\t\t\t\tsocketSend({\n\t\t\t\t\t\t\t'action': 'auth',\n\t\t\t\t\t\t\t'args': [sha1($('#password').val())]\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t$('.authorize').attr('data-original-title', config.login);\n\t};\n\n\tif(config.google_analytics_key == '') {\n\t\tlogText('Google Analytics tracking is not enabled.');\n\t} else {\n\t\tlogText('Google Analytics tracking is enabled with key ' + config.google_analytics_key);\n\n\t\t(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n\t\t(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n\t\tm=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n\t\t})(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n\t\tgoogleAnalytics('create', config.google_analytics_key, {\n\t\t\t'cookieDomain': 'none'\n\t\t});\n\n\t\tgoogleAnalytics('send', 'pageview');\n\t}\n\n\tlogText('LaserCutter software is up. Attempting connection to WebSockets host ' + host);\n\tsocketSetup();\n\tsetInterval(function() {\n\t\tif(typeof reconnectRate != 'undefined' && (typeof socket == 'undefined' || socket.readyState == socket.CLOSED)) {\n\t\t\t// initialize websockets if closed\n\t\t\tlogText('Attempting connection to WebSockets host', host);\n\t\t\tsocketSetup();\n\t\t}\n\t}, reconnectRate);\n\n});","// initialize the things\n\nwindow.console.log('This silly browser log is generally not used. Click the console button at the bottom of the page instead! If there are errors here, please raise an issue.');\n\n// holds old and new JSON\n// for comparison to minimize layout thrashing n stuff\nvar oldJsonData = 'uninitialized';\nvar jsonData;\n\n// initialize the modal by changing the title\n$('.notify-modal-title').html('Notification');\n\n// footer\n$.ajax({\n\turl: '/infotext.md',\n\ttype: 'GET'\n})\n.done(function(request) {\n\t$('.credits-footer').before(\n\t\tmarked(request)\n\t);\n})\n.fail(function() {\n\tconsole.log('Failed to get infotext.md');\n});\n\n// focus the first form element on not-mobile\nif(!isTouchDevice()) {\n\t$('.cut-human-name').focus();\n}","// main program\n\n// when jquery is here\n$(document).ready(function() {\n\n\t// when submit button clicked\n\t$('.btn-submit').click(function(clickAction) {\n\t\tclickAction.preventDefault();\n\t\tlogText(\"submit button clicked\");\n\t\tvar estimate = $('.cut-time-estimate').val().match(/\\d*(\\.\\d+)?/);\n\t\tsocketSend({\n\t\t\t\t'action': 'add',\n\t\t\t\t'args': [\n\t\t\t\t\t$('.cut-human-name').val(), \n\t\t\t\t\t+$('.priority-dropdown').val(), \n\t\t\t\t\t+estimate[0], \n\t\t\t\t\t$('.cut-material').val()\n\t\t\t\t]\n\t\t\t});\n\t\tresetForm($('.new-cut-form'));\n\t\t$('.cut-human-name').focus();\n\t\t\n\t});\n\n\tvar easterEgg = new Konami();\n\teasterEgg.code = function() {\n\t\trickRoll();\n\t};\n\teasterEgg.load();\n\n\t// or this:\n\t// easter_egg.load('https://www.youtube.com/watch?v=dQw4w9WgXcQ');\n\n});"],"sourceRoot":"/source/"}